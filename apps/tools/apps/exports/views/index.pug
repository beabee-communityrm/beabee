extends /src/views/base.pug

block prepend title
	- title = 'Exports'

block append js
	script(src='/static/js/exports.js?v=' + git)

block contents
	.row
		.col-md-12
			+page_header('Exports')

			each exportType in exportsByType
				h4= exportType.name
				p
					each e in exportType.exports
						a(href='/tools/exports/' + e._id)= e.description
						| , created #{moment(e.date).format('DD/MM/YYYY [at] HH:mm')}
						br

	.row
		.col-md-8
			hr
			h3 Create export
			form(method='POST').form-horizontal
				+csrf

				+input('text', 'Description', 'description', { left: 3, right: 6, required: true })

				.form-group
					label(for='type').col-md-3.control-label Type
					.col-md-6
						select(name='type', id='type' required).form-control.js-export-types
							option(value='' selected disabled) Select one
							each exportType, exportId in exportTypes
								option(value=exportId)= exportType.name
				
				each exportType, exportId in exportTypes
					.hidden.js-export-type(data-type=exportId)
						each param in exportType.params
							.form-group
								label.col-md-3.control-label= param.label
								.col-md-6
									if param.type === 'select'
										select(name='params[' + param.name + ']' required disabled).form-control
											each value in param.values
												option(value=value[0])= value[1]
									else
										input(type=param.type name='params[' + param.name + ']' required disabled).form-control
				.form-group
					.col-md-4.col-md-offset-3
						button.btn Create export

