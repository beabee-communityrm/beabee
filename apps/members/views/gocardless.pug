extends /src/views/notrack.pug

block prepend title
	- title = 'GoCardless'
	- page = 'gocardless'

block contents
	.row
		.col-md-3
			include partials/sidebar.pug
		.col-md-9
			+page_header( title )

			h4 Create subscription
			if member.hasActiveSubscription
				p User has a subscription
			else if !member.canTakePayment
				p User does not have an active payment method
			else
				form( method="post").form-horizontal
					+csrf
					input( type='hidden' name='action' value='create-subscription' )
					+input( 'number', 'Monthly amount', 'amount', { left: 3, right: 4, before: '£' })
					+input( 'radio', 'Period', 'period', {
						left: 3, right: 4,
						options: {'monthly': 'Monthly', 'annually': 'Annually'}
					})
					+input( 'checkbox', 'Paying fee', 'payFee', {
						left: 3, right: 4,
						options: {'true': 'Yes'}
					})
					+form_button( 'Create', 'primary', { left: 3 } )

			h4 Manual update
			.alert.alert-warning.
				If done incorrectly this could result in payments being taken but not
				recorded
			form( method="post" ).form-horizontal
				+csrf
				input( type='hidden' name='action' value='force-update' )
				+input( 'text', 'Customer ID', 'customer_id', { value: member.gocardless.customer_id, left: 3, right: 4 } )
				+input( 'text', 'Mandate ID', 'mandate_id', { value: member.gocardless.mandate_id, left: 3, right: 4 } )
				+input( 'text', 'Subscription ID', 'subscription_id', { value: member.gocardless.subscription_id, left: 3, right: 4 } )
				+input( 'number', 'Monthly amount', 'amount', { value: member.gocardless.amount, left: 3, right: 4, before: '£' } )
				+input( 'radio', 'Period', 'period', {
					value: member.gocardless.period,
					left: 3, right: 4,
					options: {'monthly': 'Monthly', 'annually': 'Annually'}
				})
				+input( 'checkbox', 'Paying fee', 'paying_fee', {
					value: member.gocardless.paying_fee,
					left: 3, right: 4,
					options: {'true': 'Yes'}
				} )
				+form_button( 'Update', 'danger', { left: 3 } )
